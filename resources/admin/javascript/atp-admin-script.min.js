var atp_data;(function(a){atp_data=JSON.parse(atp_raw_data);if(window.BoxBuilderWidget===undefined){return;}new BoxBuilderWidget("Portfolio",{title:"Portfolio Widget","class":"portfolio fa fa-briefcase",editor:function(d){d.editor.title.text("Portfolio Widget Settings");var t=d.settings;var g=a("<div/>",{"class":"available-projects-wrapper atp-section","data-section":"available"});g.appendTo(d.editor);a("<h2/>",{"class":"atbb-widget-option-heading"}).text("Available Projects").appendTo(g);a("<em/>").html("Click on projects to add them to the selected list. Projects that are selected will be used in this portfolio set.").appendTo(g);if(atp_data.posts){var n=a("<ul/>",{"class":"atp-available-projects"});a.each(atp_data.posts,function(A,z){var w=a("<li/>",{"data-id":A});var x=a("<div/>",{"class":"atp-thumbnail",title:z.title}).appendTo(w);var y=z.sizes&&z.sizes.thumb&&z.sizes.thumb[0]?z.sizes.thumb[0]:z.thumb;if(y){x.css({"background-image":"url("+y+")"});}w.appendTo(n);w.on("click",function(){if(a(this).hasClass("atp-disabled")){return;
}j({id:A,title:z.title,thumb:y});});});n.appendTo(g);}var h=a("<div/>",{"class":"selected-projects-wrapper atp-section","data-section":"selected"});h.appendTo(d.editor);a("<h2/>",{"class":"atbb-widget-option-heading"}).text("Selected Projects").appendTo(h);a("<em/>").html("Projects in this list will be used in this portfolio set. You may reorder or remove projects.").appendTo(h);var r=new d.SortableContainer("[selected-projects]");r.addClass("atp-selected-projects").appendTo(h);function j(x){if(r.has('[data-id="'+x.id+'"]').length){return;}var z=r.addGroup();z.attr({"data-id":x.id});var w=a("<div/>",{"class":"atp-thumbnail atbb-widget-options-group-handle",title:x.title}).appendTo(z);if(x.thumb){w.css({"background-image":"url("+x.thumb+")"});}var y=a("<span/>",{"class":"fa fa-times atp-remove-button"}).appendTo(w);y.on("click",function(){z.Remove();b();});z.addOption({title:"Project ID",description:"",type:"text",name:"[id]",value:x.id?x.id:""});b();}var k=a("<div/>",{"class":"categories-wrapper atp-section","data-section":"categories"});
k.appendTo(d.editor);a("<h2/>",{"class":"atbb-widget-option-heading"}).text("Categories").appendTo(k);a("<em/>").html("This list contains the categories that are asigned to the selected projects.").appendTo(k);var o=new d.SortableContainer("[selected-categories]");o.addClass("atp-categories").appendTo(k);function l(x){var y=o.addGroup();y.attr({"data-id":x.id});var w=a("<div/>",{"class":"atp-cat atbb-widget-options-group-handle",title:x.title}).text(x.title).appendTo(y);y.addOption({title:"Category ID",description:"",type:"text",name:"[id]",value:x.id?x.id:""});}function b(){var w=[];n.children().removeClass("atp-disabled");r.children().each(function(){var y=a(this).data("group");var x=a(this).attr("data-id");a.each(atp_data.posts[x].terms,function(z){if(a.inArray(z,w)===-1){w.push(z);}});n.children('[data-id="'+x+'"]').addClass("atp-disabled");});o.children("li").each(function(){var x=a(this).data("group");x.Remove();});if(t["selected-categories"]){a.each(t["selected-categories"],function(z){if(t["selected-categories"][z]){var y=t["selected-categories"][z].id;
if(atp_data.terms[y]){var x={id:y,title:atp_data.terms[y].title};if(a.inArray(y,w)!==-1){l(x);}}}});}a.each(w,function(y,A){var z=o.children('[data-id="'+A+'"]');if(z.length===0&&atp_data.terms[A]){var x={id:A,title:atp_data.terms[A].title};l(x);}});}var p=a("<div/>",{"class":"settings-wrapper atp-section","data-section":"settings"});p.appendTo(d.editor);a("<h2/>",{"class":"atbb-widget-option-heading"}).text("Portfolio Settings").appendTo(p);a("<em/>").html("Customize the portfolio to your needs by choosing the culomn layout, whether or not to use the filter/categories.").appendTo(p);a("<hr/>").appendTo(p);var s=new d.Option({title:"Portfolio Type",description:'Select portfolio type. The "Grid Portfolio" is a standard portfolio with specific number of columns, where a "Slider Portfolio" is a slideshow of images (baner rotator) and has no columns property.',type:"select",options:{grid:"Grid Portfolio",slider:"Slider Portfolio",carousel:"Carousel Portfolio"},name:"[type]",value:d.settings.type?d.settings.type:"grid"});
s.appendTo(p);var c=a("<div/>").appendTo(p);s.on("fieldchange",function(){var w=d.getSettings();c.children().remove();switch(w.type){case"grid":new d.Option({title:"Columns",description:"Select the number of columns",type:"select",options:{"1":"One Column","2":"Two Columns","3":"Three Columns","4":"Four Columns"},name:"[columns]",value:d.settings.columns?d.settings.columns:"3"}).appendTo(c);new d.Option({title:"Categories / Filters",description:"Check the box if you whish to use the filtering functionality.",type:"checkbox",name:"[use_filters]",value:d.settings.use_filters?d.settings.use_filters:false}).appendTo(c);new d.Option({title:"Show All Button Label",description:'Type in a label for "Show all projects" button in filters.',type:"text",name:"[filter_all_label]",value:d.settings.filter_all_label?d.settings.filter_all_label:"Show All"}).appendTo(c);new d.Option({title:"No Gutter",description:"Check the box to remove any spacing between the portfolio items.",type:"checkbox",name:"[no_gutter]",value:d.settings.no_gutter?d.settings.no_gutter:false}).appendTo(c);
break;case"slider":new d.Option({title:"Animation Type",description:"Set the slideshow animation type.",type:"select",options:{fade:"Fade",slide:"Slide"},name:"[animation_type]",value:d.settings.animation_type?d.settings.animation_type:"fade"}).appendTo(c);new d.Option({title:"Slideshow Speed",description:"Set the pause time between slides (in seconds).",type:"number",name:"[slideshow_speed]",step:0.1,min:0,value:d.settings.slideshow_speed?d.settings.slideshow_speed:6}).appendTo(c);new d.Option({title:"Animation Speed",description:"Set the animation duration (in seconds).",type:"number",name:"[animation_speed]",step:0.1,min:0,value:d.settings.animation_speed?d.settings.animation_speed:0.6}).appendTo(c);new d.Option({title:"Use Directional Controls",description:"Check the box if you wish to have next and previous buttons for the slider.",type:"checkbox",name:"[use_controls]",value:d.settings.use_controls?d.settings.use_controls:false}).appendTo(c);new d.Option({title:"Use Pagination Controls",description:'Check the box if you wish to have the pagination buttons ("Dots Naviagtion") for the slider.',type:"checkbox",name:"[use_paginate_controls]",value:d.settings.use_paginate_controls?d.settings.use_paginate_controls:false}).appendTo(c);
break;case"carousel":new d.Option({title:"Columns",description:"Select the number of columns",type:"select",options:{"2":"Two Columns","3":"Three Columns","4":"Four Columns"},name:"[columns]",value:d.settings.columns?d.settings.columns:"3"}).appendTo(c);new d.Option({title:"Use Directional Controls",description:"Check the box if you wish to have next and previous buttons for the slider.",type:"checkbox",name:"[use_controls]",value:d.settings.use_controls?d.settings.use_controls:false}).appendTo(c);new d.Option({title:"Use Pagination Controls",description:'Check the box if you wish to have the pagination buttons ("Dots Naviagtion") for the slider.',type:"checkbox",name:"[use_paginate_controls]",value:d.settings.use_paginate_controls?d.settings.use_paginate_controls:false}).appendTo(c);new d.Option({title:"No Gutter",description:"Check the box to remove any spacing between the portfolio items.",type:"checkbox",name:"[no_gutter]",value:d.settings.no_gutter?d.settings.no_gutter:false}).appendTo(c);
break;}});s.trigger("fieldchange");a("<hr/>").appendTo(p);var e=new d.Option({title:"Add All Projects",description:"Check the box if you wish to add all projects to this portfolio automatically.",type:"checkbox",name:"[all_projects]",value:d.settings.all_projects?d.settings.all_projects:false,}).appendTo(p);new d.Option({title:"Ignore Project Thumbnail",description:'Check the box if you wish to use the "Featured Image" of a project as its thumbnail instead of the "Project Thumbnail" option field.',type:"checkbox",name:"[ignore_thumb]",value:d.settings.ignore_thumb?d.settings.ignore_thumb:false,}).appendTo(p);new d.Option({title:"Additional CSS Class",description:"This option puts the content into an additional element and applies the class-name set below, allowing you to apply specific styling via CSS.",type:"text",name:"[class]",value:d.settings["class"]?d.settings["class"]:"",placeholder:"Example: awesome-css-class"}).appendTo(p);if(t["selected-projects"]){a.each(t["selected-projects"],function(x){if(t["selected-projects"][x]){var y=t["selected-projects"][x].id;
if(atp_data.posts[y]){var w={id:y,title:atp_data.posts[y].title,thumb:atp_data.posts[y].sizes.thumb[0]};j(w);}}});}var m=new d.editor.HeaderControl("fa-cogs atp-tab");m.attr({"data-section":"settings"}).setLabel("Settings");new d.editor.HeaderControl("atbb-widget-editor-header-separator");var v=new d.editor.HeaderControl("fa-bookmark atp-tab");v.attr({"data-section":"categories"}).setLabel("Categories");var u=new d.editor.HeaderControl("fa-check atp-tab");u.attr({"data-section":"selected"}).setLabel("Selected");var q=new d.editor.HeaderControl("fa-paperclip atp-tab");q.attr({"data-section":"available"}).setLabel("Available");d.find(".atp-tab").on("click",function(){var w=a(this).attr("data-section");d.find(".atp-tab").removeClass("atp-active-tab");a(this).addClass("atp-active-tab");d.editor.find(".atp-section").removeClass("atp-active-section");d.editor.find('.atp-section[data-section="'+w+'"]').addClass("atp-active-section");});q.trigger("click");e.on("change",function(){var w=a(this).find('[type="checkbox"]').prop("checked");
if(w){i();r.addClass("atp-disable-removes");}else{r.removeClass("atp-disable-removes");}});e.trigger("change");d.on("onsave",function(){i();var y=d.getSettings();var x=y["selected-projects"]?y["selected-projects"]:{};var z=a("<div/>",{"class":"atp-portfolio-content"});var w=a("<ul/>",{"class":"atp-portfolio atp-portfolio-"+y.type+" atp-columns-"+(y.columns?y.columns:1)}).appendTo(z);a.each(x,function(B,C){var A=atp_data.posts[C.id].thumb;if((parseInt(y.columns)<3)||y.type==="slider"){A=atp_data.posts[C.id].sizes.large[0]||atp_data.posts[C.id].thumb;}a("<li/>").css({"background-image":"url("+A+")"}).appendTo(w);});d.setContent(a("<div/>").append(z).html());});function f(){var z=d.getSettings();var w=d.content.find(".atp-portfolio-content");var x=w.find(".atp-portfolio > li");var A=parseInt(x.eq(0).css("margin-right"));var y=x.eq(0).width();var B=parseInt(z.columns)||3;if(w.flexslider){if(z.type==="slider"){x.css({height:w.width()*70/100,});w.flexslider({namespace:"atp-preview-",selector:".atp-portfolio > li",animation:"slide",smoothHeight:true,controlNav:true,directionNav:false,prevText:"",nextText:"",slideshowSpeed:6000,animationSpeed:500,useCSS:true,slideshow:false,start:function(){}});
}else{if(z.type==="carousel"){w.flexslider({namespace:"atp-preview-",selector:".atp-portfolio > li",animation:"slide",animationLoop:false,itemWidth:Math.floor(y),itemMargin:A,maxItems:B,smoothHeight:false,controlNav:true,directionNav:false,prevText:"",nextText:"",slideshowSpeed:6000,animationSpeed:500,useCSS:true,slideshow:false,start:function(){x.css({height:y,"margin-right":A});}});}}}}function i(){if(atp_data.posts){a.each(atp_data.posts,function(y,x){var w=x.sizes&&x.sizes.thumb&&x.sizes.thumb[0]?x.sizes.thumb[0]:x.thumb;if(d.settings.all_projects){j({id:y,title:x.title,thumb:w});}});}}i();d.on("oncontent",function(){f();});},output:function(h,i){var j="";var r=h.getSettings();var f=atp_data.shortcodes[r.type]?atp_data.shortcodes[r.type]:false;if(!f){return j;}var s=(r["class"]?r["class"]:"");var b=r.ignore_thumb?'ignorethumb="true" ':"";var p=r.all_projects?'allprojects="true" ':"";var q=r["selected-projects"]?r["selected-projects"]:{};var t=r["selected-categories"]?r["selected-categories"]:{};
var l=[];var m=[];a.each(q,function(w,x){l.push(x.id);});a.each(t,function(w,x){m.push(x.id);});if(l.length){switch(r.type){case"grid":var d=r.columns?'columns="'+r.columns+'" ':'columns="3" ';var k=r.use_filters?'filters="true" ':"";var u=r.filter_all_label?'showall="'+r.filter_all_label+'" ':"";var g=r.no_gutter?'nogutter="true" ':"";j+="["+f+' type="'+r.type+'" ';j+='projects="'+l.join(",")+'" ';j+='categories="'+m.join(",")+'" ';j+=d+k+u+g+b+p;j+=i.mode?'section_width="'+i.mode+'" ':"";j+=i.row_mode?'row_width="'+i.row_mode+'" ':"";j+=s!==""?'classes="'+s+'"':"";j+="/]";break;case"slider":var o=r.animation_type?'animation="'+r.animation_type+'" ':'animation="fade" ';var v=r.slideshow_speed?'slidespeed="'+r.slideshow_speed+'" ':'slidespeed="6" ';var c=r.animation_speed?'animspeed="'+r.animation_speed+'" ':'animspeed="0.6" ';var e=r.use_controls?'dircontrols="true" ':"";var n=r.use_paginate_controls?'navcontrols="true" ':"";j+="["+f+' type="'+r.type+'" ';j+='projects="'+l.join(",")+'" ';
j+='categories="'+m.join(",")+'" ';j+=o+v+c+e+n+b+p;j+=i.mode?'section_width="'+i.mode+'" ':"";j+=i.row_mode?'row_width="'+i.row_mode+'" ':"";j+=s!==""?'classes="'+s+'"':"";j+="/]";break;case"carousel":var d=r.columns?'columns="'+r.columns+'" ':'columns="3" ';var e=r.use_controls?'dircontrols="true" ':"";var n=r.use_paginate_controls?'navcontrols="true" ':"";var g=r.no_gutter?'nogutter="true" ':"";j+="["+f+' type="'+r.type+'" ';j+='projects="'+l.join(",")+'" ';j+='categories="'+m.join(",")+'" ';j+=d+e+n+g+b+p;j+=i.mode?'section_width="'+i.mode+'" ':"";j+=i.row_mode?'row_width="'+i.row_mode+'" ':"";j+=s!==""?'classes="'+s+'"':"";j+="/]";break;}}return j;}});})(jQuery);(function(a){a(".atp-meta-option-thumb").on("click",function(){var c=a(this);var d=a(".atp-meta-option").has(this);var e=d.find("input");var b=new BoxBuilderMediaWindow({title:c.attr("title"),button:c.attr("title"),library:"image"});b.on("mediaselect",function(f,g){d.addClass("atp-has-image");e.val(g.id);c.find("img").remove();
a("<img/>",{src:g.url}).appendTo(c);});});a(".atp-remove-thumb").on("click",function(){var b=a(this);var c=a(".atp-meta-option").has(this);var d=c.find("input");c.removeClass("atp-has-image").find("img").remove();d.val("");});})(jQuery);